{"version":3,"file":"useDevicePerformance-Wloqg_hY.js","sources":["../../src/hooks/useDevicePerformance.ts"],"sourcesContent":["import { useState, useEffect } from 'react';\n\ninterface DevicePerformance {\n  isLowEnd: boolean;\n  memoryInfo?: {\n    totalJSHeapSize: number;\n    usedJSHeapSize: number;\n    jsHeapSizeLimit: number;\n  };\n  connectionSpeed: 'slow' | 'fast' | 'unknown';\n  reducedMotion: boolean;\n  shouldReduceAnimations: boolean;\n}\n\nexport const useDevicePerformance = (): DevicePerformance => {\n  const [performance, setPerformance] = useState<DevicePerformance>({\n    isLowEnd: false,\n    connectionSpeed: 'unknown',\n    reducedMotion: false,\n    shouldReduceAnimations: false,\n  });\n\n  useEffect(() => {\n    const detectPerformance = () => {\n      // Check for reduced motion preference\n      const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;\n\n      // Detect device memory (if available)\n      const navigator = window.navigator as any;\n      const deviceMemory = navigator.deviceMemory || 4; // Default to 4GB if not available\n\n      // Detect network connection\n      const connection = (navigator.connection ||\n        navigator.mozConnection ||\n        navigator.webkitConnection) as any;\n      const connectionSpeed = connection\n        ? connection.effectiveType === 'slow-2g' || connection.effectiveType === '2g'\n          ? 'slow'\n          : 'fast'\n        : 'unknown';\n\n      // Detect if device is low-end based on multiple factors\n      const isLowEnd =\n        deviceMemory < 2 || // Less than 2GB RAM\n        connectionSpeed === 'slow' ||\n        navigator.hardwareConcurrency < 4; // Less than 4 CPU cores\n\n      // Get memory info if available (Chrome only)\n      const memoryInfo = (performance as any).memory\n        ? {\n            totalJSHeapSize: (performance as any).memory.totalJSHeapSize,\n            usedJSHeapSize: (performance as any).memory.usedJSHeapSize,\n            jsHeapSizeLimit: (performance as any).memory.jsHeapSizeLimit,\n          }\n        : undefined;\n\n      setPerformance({\n        isLowEnd,\n        memoryInfo,\n        connectionSpeed,\n        reducedMotion: prefersReducedMotion,\n        shouldReduceAnimations: isLowEnd || prefersReducedMotion,\n      });\n    };\n\n    detectPerformance();\n\n    // Listen for changes in reduced motion preference\n    const mediaQuery = window.matchMedia('(prefers-reduced-motion: reduce)');\n    const handleChange = () => detectPerformance();\n\n    mediaQuery.addEventListener('change', handleChange);\n    return () => mediaQuery.removeEventListener('change', handleChange);\n  }, []);\n\n  return performance;\n};\n\n// Hook for monitoring frame rate and performance\nexport const useFrameRate = () => {\n  const [fps, setFps] = useState(60);\n  const [isStable, setIsStable] = useState(true);\n\n  useEffect(() => {\n    let frameCount = 0;\n    let lastTime = performance.now();\n    let fpsArray: number[] = [];\n\n    const measureFPS = () => {\n      frameCount++;\n      const currentTime = performance.now();\n\n      if (currentTime >= lastTime + 1000) {\n        const currentFPS = Math.round((frameCount * 1000) / (currentTime - lastTime));\n        fpsArray.push(currentFPS);\n\n        // Keep only last 10 measurements\n        if (fpsArray.length > 10) {\n          fpsArray = fpsArray.slice(-10);\n        }\n\n        const avgFPS = fpsArray.reduce((a, b) => a + b, 0) / fpsArray.length;\n        setFps(Math.round(avgFPS));\n\n        // Consider stable if FPS is consistently above 30\n        setIsStable(avgFPS > 30);\n\n        frameCount = 0;\n        lastTime = currentTime;\n      }\n\n      requestAnimationFrame(measureFPS);\n    };\n\n    const animationId = requestAnimationFrame(measureFPS);\n    return () => cancelAnimationFrame(animationId);\n  }, []);\n\n  return { fps, isStable };\n};\n\n// Hook for adaptive animation settings\nexport const useAdaptiveAnimations = () => {\n  const devicePerf = useDevicePerformance();\n  const { fps, isStable } = useFrameRate();\n\n  const getAnimationConfig = () => {\n    if (devicePerf.shouldReduceAnimations || !isStable || fps < 30) {\n      return {\n        duration: 0.3, // Faster animations\n        particles: false,\n        heavyEffects: false,\n        staggerDelay: 0.05,\n        quality: 'low',\n      };\n    }\n\n    if (devicePerf.isLowEnd || fps < 50) {\n      return {\n        duration: 0.4,\n        particles: false,\n        heavyEffects: false,\n        staggerDelay: 0.08,\n        quality: 'medium',\n      };\n    }\n\n    return {\n      duration: 0.6,\n      particles: true,\n      heavyEffects: true,\n      staggerDelay: 0.1,\n      quality: 'high',\n    };\n  };\n\n  return {\n    ...devicePerf,\n    fps,\n    isStable,\n    config: getAnimationConfig(),\n  };\n};\n"],"names":["useDevicePerformance","performance","setPerformance","useState","useEffect","detectPerformance","prefersReducedMotion","navigator","deviceMemory","connection","connectionSpeed","isLowEnd","memoryInfo","mediaQuery","handleChange","useFrameRate","fps","setFps","isStable","setIsStable","frameCount","lastTime","fpsArray","measureFPS","currentTime","currentFPS","avgFPS","a","b","animationId","useAdaptiveAnimations","devicePerf"],"mappings":"qCAcO,MAAMA,EAAuB,IAAyB,CAC3D,KAAM,CAACC,EAAaC,CAAc,EAAIC,WAA4B,CAChE,SAAU,GACV,gBAAiB,UACjB,cAAe,GACf,uBAAwB,EAAA,CACzB,EAEDC,OAAAA,EAAAA,UAAU,IAAM,CACd,MAAMC,EAAoB,IAAM,CAE9B,MAAMC,EAAuB,OAAO,WAAW,kCAAkC,EAAE,QAG7EC,EAAY,OAAO,UACnBC,EAAeD,EAAU,cAAgB,EAGzCE,EAAcF,EAAU,YAC5BA,EAAU,eACVA,EAAU,iBACNG,EAAkBD,EACpBA,EAAW,gBAAkB,WAAaA,EAAW,gBAAkB,KACrE,OACA,OACF,UAGEE,EACJH,EAAe,GACfE,IAAoB,QACpBH,EAAU,oBAAsB,EAG5BK,EAAcX,EAAoB,OACpC,CACE,gBAAkBA,EAAoB,OAAO,gBAC7C,eAAiBA,EAAoB,OAAO,eAC5C,gBAAkBA,EAAoB,OAAO,eAAA,EAE/C,OAEJC,EAAe,CACb,SAAAS,EACA,WAAAC,EACA,gBAAAF,EACA,cAAeJ,EACf,uBAAwBK,GAAYL,CAAA,CACrC,CACH,EAEAD,EAAA,EAGA,MAAMQ,EAAa,OAAO,WAAW,kCAAkC,EACjEC,EAAe,IAAMT,EAAA,EAE3B,OAAAQ,EAAW,iBAAiB,SAAUC,CAAY,EAC3C,IAAMD,EAAW,oBAAoB,SAAUC,CAAY,CACpE,EAAG,CAAA,CAAE,EAEEb,CACT,EAGac,EAAe,IAAM,CAChC,KAAM,CAACC,EAAKC,CAAM,EAAId,EAAAA,SAAS,EAAE,EAC3B,CAACe,EAAUC,CAAW,EAAIhB,EAAAA,SAAS,EAAI,EAE7CC,OAAAA,EAAAA,UAAU,IAAM,CACd,IAAIgB,EAAa,EACbC,EAAW,YAAY,IAAA,EACvBC,EAAqB,CAAA,EAEzB,MAAMC,EAAa,IAAM,CACvBH,IACA,MAAMI,EAAc,YAAY,IAAA,EAEhC,GAAIA,GAAeH,EAAW,IAAM,CAClC,MAAMI,EAAa,KAAK,MAAOL,EAAa,KAASI,EAAcH,EAAS,EAC5EC,EAAS,KAAKG,CAAU,EAGpBH,EAAS,OAAS,KACpBA,EAAWA,EAAS,MAAM,GAAG,GAG/B,MAAMI,EAASJ,EAAS,OAAO,CAACK,EAAGC,IAAMD,EAAIC,EAAG,CAAC,EAAIN,EAAS,OAC9DL,EAAO,KAAK,MAAMS,CAAM,CAAC,EAGzBP,EAAYO,EAAS,EAAE,EAEvBN,EAAa,EACbC,EAAWG,CACb,CAEA,sBAAsBD,CAAU,CAClC,EAEMM,EAAc,sBAAsBN,CAAU,EACpD,MAAO,IAAM,qBAAqBM,CAAW,CAC/C,EAAG,CAAA,CAAE,EAEE,CAAE,IAAAb,EAAK,SAAAE,CAAA,CAChB,EAGaY,EAAwB,IAAM,CACzC,MAAMC,EAAa/B,EAAA,EACb,CAAE,IAAAgB,EAAK,SAAAE,CAAA,EAAaH,EAAA,EAgC1B,MAAO,CACL,GAAGgB,EACH,IAAAf,EACA,SAAAE,EACA,OAjCIa,EAAW,wBAA0B,CAACb,GAAYF,EAAM,GACnD,CACL,SAAU,GACV,UAAW,GACX,aAAc,GACd,aAAc,IACd,QAAS,KAAA,EAITe,EAAW,UAAYf,EAAM,GACxB,CACL,SAAU,GACV,UAAW,GACX,aAAc,GACd,aAAc,IACd,QAAS,QAAA,EAIN,CACL,SAAU,GACV,UAAW,GACX,aAAc,GACd,aAAc,GACd,QAAS,MAAA,CAQgB,CAE/B"}